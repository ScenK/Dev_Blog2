var qq=function(a){return{hide:function(){a.style.display="none";return this},attach:function(c,b){if(a.addEventListener){a.addEventListener(c,b,false)}else{if(a.attachEvent){a.attachEvent("on"+c,b)}}return function(){qq(a).detach(c,b)}},detach:function(c,b){if(a.removeEventListener){a.removeEventListener(c,b,false)}else{if(a.attachEvent){a.detachEvent("on"+c,b)}}return this},contains:function(b){if(a===b){return true}if(a.contains){return a.contains(b)}else{return !!(b.compareDocumentPosition(a)&8)}},insertBefore:function(b){b.parentNode.insertBefore(a,b);return this},remove:function(){a.parentNode.removeChild(a);return this},css:function(b){if(b.opacity!==null){if(typeof a.style.opacity!=="string"&&typeof(a.filters)!=="undefined"){b.filter="alpha(opacity="+Math.round(100*b.opacity)+")"}}qq.extend(a.style,b);return this},hasClass:function(b){var c=new RegExp("(^| )"+b+"( |$)");return c.test(a.className)},addClass:function(b){if(!qq(a).hasClass(b)){a.className+=" "+b}return this},removeClass:function(b){var c=new RegExp("(^| )"+b+"( |$)");a.className=a.className.replace(c," ").replace(/^\s+|\s+$/g,"");return this},getByClass:function(c){var d,b=[];if(a.querySelectorAll){return a.querySelectorAll("."+c)}d=a.getElementsByTagName("*");qq.each(d,function(e,f){if(qq(f).hasClass(c)){b.push(f)}});return b},children:function(){var b=[],c=a.firstChild;while(c){if(c.nodeType===1){b.push(c)}c=c.nextSibling}return b},setText:function(b){a.innerText=b;a.textContent=b;return this},clearText:function(){return qq(a).setText("")}}};qq.log=function(a,b){if(window.console){if(!b||b==="info"){window.console.log(a)}else{if(window.console[b]){window.console[b](a)}else{window.console.log("<"+b+"> "+a)}}}};qq.isObject=function(a){return a!==null&&a&&typeof(a)==="object"&&a.constructor===Object};qq.isFunction=function(a){return typeof(a)==="function"};qq.isFileOrInput=function(a){if(window.File&&a instanceof File){return true}else{if(window.HTMLInputElement){if(a instanceof HTMLInputElement){if(a.type&&a.type.toLowerCase()==="file"){return true}}}else{if(a.tagName){if(a.tagName.toLowerCase()==="input"){if(a.type&&a.type.toLowerCase()==="file"){return true}}}}}return false};qq.isXhrUploadSupported=function(){var a=document.createElement("input");a.type="file";return(a.multiple!==undefined&&typeof File!=="undefined"&&typeof FormData!=="undefined"&&typeof(new XMLHttpRequest()).upload!=="undefined")};qq.isFolderDropSupported=function(a){return(a.items&&a.items[0].webkitGetAsEntry)};qq.isFileChunkingSupported=function(){return !qq.android()&&qq.isXhrUploadSupported()&&(File.prototype.slice||File.prototype.webkitSlice||File.prototype.mozSlice)};qq.extend=function(c,b,a){qq.each(b,function(e,d){if(a&&qq.isObject(d)){if(c[e]===undefined){c[e]={}}qq.extend(c[e],d,true)}else{c[e]=d}})};qq.indexOf=function(b,c,d){if(b.indexOf){return b.indexOf(c,d)}d=d||0;var a=b.length;if(d<0){d+=a}for(;d<a;d+=1){if(b.hasOwnProperty(d)&&b[d]===c){return d}}return -1};qq.getUniqueId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){var b=Math.random()*16|0,a=d=="x"?b:(b&3|8);return a.toString(16)})};qq.ie=function(){return navigator.userAgent.indexOf("MSIE")!==-1};qq.ie10=function(){return navigator.userAgent.indexOf("MSIE 10")!==-1};qq.safari=function(){return navigator.vendor!==undefined&&navigator.vendor.indexOf("Apple")!==-1};qq.chrome=function(){return navigator.vendor!==undefined&&navigator.vendor.indexOf("Google")!==-1};qq.firefox=function(){return(navigator.userAgent.indexOf("Mozilla")!==-1&&navigator.vendor!==undefined&&navigator.vendor==="")};qq.windows=function(){return navigator.platform==="Win32"};qq.android=function(){return navigator.userAgent.toLowerCase().indexOf("android")!==-1};qq.preventDefault=function(a){if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}};qq.toElement=(function(){var a=document.createElement("div");return function(c){a.innerHTML=c;var b=a.firstChild;a.removeChild(b);return b}}());qq.each=function(c,d){var a,b;if(c){for(a in c){if(Object.prototype.hasOwnProperty.call(c,a)){b=d(a,c[a]);if(b===false){break}}}}};qq.obj2url=function(f,b,h){var c,a,g=[],d="&",e=function(k,j){var l=b?(/\[\]$/.test(b))?b:b+"["+j+"]":j;if((l!=="undefined")&&(j!=="undefined")){g.push((typeof k==="object")?qq.obj2url(k,l,true):(Object.prototype.toString.call(k)==="[object Function]")?encodeURIComponent(l)+"="+encodeURIComponent(k()):encodeURIComponent(l)+"="+encodeURIComponent(k))}};if(!h&&b){d=(/\?/.test(b))?(/\?$/.test(b))?"":"&":"?";g.push(b);g.push(qq.obj2url(f))}else{if((Object.prototype.toString.call(f)==="[object Array]")&&(typeof f!=="undefined")){for(c=-1,a=f.length;c<a;c+=1){e(f[c],c)}}else{if((typeof f!=="undefined")&&(f!==null)&&(typeof f==="object")){for(c in f){if(f.hasOwnProperty(c)){e(f[c],c)}}}else{g.push(encodeURIComponent(b)+"="+encodeURIComponent(f))}}}if(b){return g.join(d)}else{return g.join(d).replace(/^&/,"").replace(/%20/g,"+")}};qq.obj2FormData=function(c,b,a){if(!b){b=new FormData()}qq.each(c,function(d,e){d=a?a+"["+d+"]":d;if(qq.isObject(e)){qq.obj2FormData(e,b,d)}else{if(qq.isFunction(e)){b.append(encodeURIComponent(d),encodeURIComponent(e()))}else{b.append(encodeURIComponent(d),encodeURIComponent(e))}}});return b};qq.obj2Inputs=function(c,b){var a;if(!b){b=document.createElement("form")}qq.obj2FormData(c,{append:function(d,e){a=document.createElement("input");a.setAttribute("name",d);a.setAttribute("value",e);b.appendChild(a)}});return b};qq.setCookie=function(c,d,e){var b=new Date(),a="";if(e){b.setTime(b.getTime()+(e*24*60*60*1000));a="; expires="+b.toGMTString()}document.cookie=c+"="+d+a+"; path=/"};qq.getCookie=function(b){var e=b+"=",a=document.cookie.split(";"),f;for(var d=0;d<a.length;d++){f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length)}if(f.indexOf(e)===0){return f.substring(e.length,f.length)}}};qq.getCookieNames=function(b){var a=document.cookie.split(";"),c=[];qq.each(a,function(d,e){e=e.trim();var f=e.indexOf("=");if(e.match(b)){c.push(e.substr(0,f))}});return c};qq.deleteCookie=function(a){qq.setCookie(a,"",-1)};qq.areCookiesEnabled=function(){var b=Math.random()*100000,a="qqCookieTest:"+b;qq.setCookie(a,1);if(qq.getCookie(a)){qq.deleteCookie(a);return true}return false};qq.parseJson=function(json){if(typeof JSON.parse==="function"){return JSON.parse(json)}else{return eval("("+json+")")}};qq.DisposeSupport=function(){var a=[];return{dispose:function(){var b;do{b=a.shift();if(b){b()}}while(b)},attach:function(){var b=arguments;this.addDisposer(qq(b[0]).attach.apply(this,Array.prototype.slice.call(arguments,1)))},addDisposer:function(b){a.push(b)}}};qq.UploadButton=function(a){this._options={element:null,multiple:false,acceptFiles:null,name:"file",onChange:function(b){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"};qq.extend(this._options,a);this._disposeSupport=new qq.DisposeSupport();this._element=this._options.element;qq(this._element).css({position:"relative",overflow:"hidden",direction:"ltr"});this._input=this._createInput()};qq.UploadButton.prototype={getInput:function(){return this._input},reset:function(){if(this._input.parentNode){qq(this._input).remove()}qq(this._element).removeClass(this._options.focusClass);this._input=this._createInput()},_createInput:function(){var b=document.createElement("input");if(this._options.multiple){b.setAttribute("multiple","multiple")}if(this._options.acceptFiles){b.setAttribute("accept",this._options.acceptFiles)}b.setAttribute("type","file");b.setAttribute("name",this._options.name);qq(b).css({position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0});this._element.appendChild(b);var a=this;this._disposeSupport.attach(b,"change",function(){a._options.onChange(b)});this._disposeSupport.attach(b,"mouseover",function(){qq(a._element).addClass(a._options.hoverClass)});this._disposeSupport.attach(b,"mouseout",function(){qq(a._element).removeClass(a._options.hoverClass)});this._disposeSupport.attach(b,"focus",function(){qq(a._element).addClass(a._options.focusClass)});this._disposeSupport.attach(b,"blur",function(){qq(a._element).removeClass(a._options.focusClass)});if(window.attachEvent){b.setAttribute("tabIndex","-1")}return b}};qq.UploadHandler=function(f){var a=[],c,d,e,b;c={debug:false,forceMultipart:true,paramsInBody:false,paramsStore:{},endpointStore:{},maxConnections:3,uuidParamName:"qquuid",totalFileSizeParamName:"qqtotalfilesize",chunking:{enabled:false,partSize:2000000,paramNames:{partIndex:"qqpartindex",partByteOffset:"qqpartbyteoffset",chunkSize:"qqchunksize",totalParts:"qqtotalparts",filename:"qqfilename"}},resume:{enabled:false,id:null,cookiesExpireIn:7,paramNames:{resuming:"qqresume"}},log:function(g,h){},onProgress:function(j,i,g,h){},onComplete:function(j,i,g,h){},onCancel:function(h,g){},onUpload:function(h,g){},onUploadChunk:function(i,h,g){},onAutoRetry:function(j,i,g,h){},onResume:function(i,h,g){}};qq.extend(c,f);d=c.log;e=function(k){var h=qq.indexOf(a,k),g=c.maxConnections,j;a.splice(h,1);if(a.length>=g&&h<g){j=a[g-1];b.upload(j)}};if(qq.isXhrUploadSupported()){b=new qq.UploadHandlerXhr(c,e,d)}else{b=new qq.UploadHandlerForm(c,e,d)}return{add:function(g){return b.add(g)},upload:function(h){var g=a.push(h);if(g<=c.maxConnections){return b.upload(h)}},retry:function(h){var g=qq.indexOf(a,h);if(g>=0){return b.upload(h,true)}else{return this.upload(h)}},cancel:function(g){d("Cancelling "+g);c.paramsStore.remove(g);b.cancel(g);e(g)},cancelAll:function(){qq.each(a,function(g,h){this.cancel(h)});a=[]},getName:function(g){return b.getName(g)},getSize:function(g){if(b.getSize){return b.getSize(g)}},getFile:function(g){if(b.getFile){return b.getFile(g)}},getQueue:function(){return a},reset:function(){d("Resetting upload handler");a=[];b.reset()},getUuid:function(g){return b.getUuid(g)},isValid:function(g){return b.isValid(g)},getResumableFilesData:function(){if(b.getResumableFilesData){return b.getResumableFilesData()}return[]}}};qq.UploadHandlerForm=function(o,uploadCompleteCallback,logCallback){var options=o,inputs=[],uuids=[],detachLoadEvents={},uploadComplete=uploadCompleteCallback,log=logCallback,api;function attachLoadEvent(iframe,callback){detachLoadEvents[iframe.id]=qq(iframe).attach("load",function(){log("Received response for "+iframe.id);if(!iframe.parentNode){return}try{if(iframe.contentDocument&&iframe.contentDocument.body&&iframe.contentDocument.body.innerHTML=="false"){return}}catch(error){log("Error when attempting to access iframe during handling of upload response ("+error+")","error")}callback()})}function getIframeContentJson(iframe){var response;try{var doc=iframe.contentDocument||iframe.contentWindow.document,innerHTML=doc.body.innerHTML;log("converting iframe's innerHTML to JSON");log("innerHTML = "+innerHTML);if(innerHTML&&innerHTML.match(/^<pre/i)){innerHTML=doc.body.firstChild.firstChild.nodeValue}response=eval("("+innerHTML+")")}catch(error){log("Error when attempting to parse form upload response ("+error+")","error");response={success:false}}return response}function createIframe(id){var iframe=qq.toElement('<iframe src="javascript:false;" name="'+id+'" />');iframe.setAttribute("id",id);iframe.style.display="none";document.body.appendChild(iframe);return iframe}function createForm(id,iframe){var params=options.paramsStore.getParams(id),protocol=options.demoMode?"GET":"POST",form=qq.toElement('<form method="'+protocol+'" enctype="multipart/form-data"></form>'),endpoint=options.endpointStore.getEndpoint(id),url=endpoint;params[options.uuidParamName]=uuids[id];if(!options.paramsInBody){url=qq.obj2url(params,endpoint)}else{qq.obj2Inputs(params,form)}form.setAttribute("action",url);form.setAttribute("target",iframe.name);form.style.display="none";document.body.appendChild(form);return form}api={add:function(fileInput){fileInput.setAttribute("name",options.inputName);var id=inputs.push(fileInput)-1;uuids[id]=qq.getUniqueId();if(fileInput.parentNode){qq(fileInput).remove()}return id},getName:function(id){return inputs[id].value.replace(/.*(\/|\\)/,"")},isValid:function(id){return inputs[id]!==undefined},reset:function(){qq.UploadHandler.prototype.reset.apply(this,arguments);inputs=[];uuids=[];detachLoadEvents={}},getUuid:function(id){return uuids[id]},cancel:function(id){options.onCancel(id,this.getName(id));delete inputs[id];delete uuids[id];delete detachLoadEvents[id];var iframe=document.getElementById(id);if(iframe){iframe.setAttribute("src","java"+String.fromCharCode(115)+"cript:false;");qq(iframe).remove()}},upload:function(id){var input=inputs[id],fileName=api.getName(id),iframe=createIframe(id),form=createForm(id,iframe);if(!input){throw new Error("file with passed id was not added, or already uploaded or cancelled")}options.onUpload(id,this.getName(id));form.appendChild(input);attachLoadEvent(iframe,function(){log("iframe loaded");var response=getIframeContentJson(iframe);setTimeout(function(){detachLoadEvents[id]();delete detachLoadEvents[id];qq(iframe).remove()},1);if(!response.success){if(options.onAutoRetry(id,fileName,response)){return}}options.onComplete(id,fileName,response);uploadComplete(id)});log("Sending upload request for "+id);form.submit();qq(form).remove();return id}};return api};qq.UploadHandlerXhr=function(F,s,k){var q=F,b=s,f=k,E=[],p="|",C=q.chunking.enabled&&qq.isFileChunkingSupported(),j=q.resume.enabled&&C&&qq.areCookiesEnabled(),w=t(),l=q.forceMultipart||q.paramsInBody,d;function i(R,Q,o){var P=d.getSize(R),O=d.getName(R);Q[q.chunking.paramNames.partIndex]=o.part;Q[q.chunking.paramNames.partByteOffset]=o.start;Q[q.chunking.paramNames.chunkSize]=o.end-o.start;Q[q.chunking.paramNames.totalParts]=o.count;Q[q.totalFileSizeParamName]=P;if(l){Q[q.chunking.paramNames.filename]=O}}function r(o){o[q.resume.paramNames.resuming]=true}function M(o,P,O){if(o.slice){return o.slice(P,O)}else{if(o.mozSlice){return o.mozSlice(P,O)}else{if(o.webkitSlice){return o.webkitSlice(P,O)}}}}function L(U,R){var T=q.chunking.partSize,o=d.getSize(U),P=E[U].file,S=T*R,Q=S+T>=o?o:S+T,O=z(U);return{part:R,start:S,end:Q,count:O,blob:M(P,S,Q)}}function z(P){var o=d.getSize(P),O=q.chunking.partSize;return Math.ceil(o/O)}function D(o){E[o].xhr=new XMLHttpRequest();return E[o].xhr}function n(R,T,S,P){var Q=new FormData(),U=q.demoMode?"GET":"POST",V=q.endpointStore.getEndpoint(P),O=V,o=d.getName(P),W=d.getSize(P);R[q.uuidParamName]=E[P].uuid;if(l){R[q.totalFileSizeParamName]=W}if(!q.paramsInBody){R[q.inputName]=o;O=qq.obj2url(R,V)}T.open(U,O,true);if(l){if(q.paramsInBody){qq.obj2FormData(R,Q)}Q.append(q.inputName,S);return Q}return S}function x(R,Q){var P=q.customHeaders,o=d.getName(R),O=E[R].file;Q.setRequestHeader("X-Requested-With","XMLHttpRequest");Q.setRequestHeader("Cache-Control","no-cache");if(!l){Q.setRequestHeader("Content-Type","application/octet-stream");Q.setRequestHeader("X-Mime-Type",O.type)}qq.each(P,function(S,T){Q.setRequestHeader(S,T)})}function J(R,o,Q){var O=d.getName(R),P=d.getSize(R);E[R].attemptingResume=false;q.onProgress(R,O,P,P);q.onComplete(R,O,o,Q);delete E[R].xhr;b(R)}function N(T){var o=L(T,E[T].remainingChunkIdxs[0]),S=D(T),P=d.getSize(T),O=d.getName(T),Q,R;if(E[T].loaded===undefined){E[T].loaded=0}m(T,o);S.onreadystatechange=c(T,S);S.upload.onprogress=function(V){if(V.lengthComputable){if(E[T].loaded<P){var U=V.loaded+E[T].loaded;q.onProgress(T,O,U,P)}}};q.onUploadChunk(T,O,H(o));R=q.paramsStore.getParams(T);i(T,R,o);if(E[T].attemptingResume){r(R)}Q=n(R,S,o.blob,T);x(T,S);f("Sending chunked upload request for "+T+": bytes "+(o.start+1)+"-"+o.end+" of "+P);S.send(Q)}function y(R,O,Q){var P=E[R].remainingChunkIdxs.shift(),o=L(R,P);E[R].attemptingResume=false;E[R].loaded+=o.end-o.start;if(E[R].remainingChunkIdxs.length>0){N(R)}else{g(R);J(R,O,Q)}}function K(O,o){return O.status!==200||!o.success||o.reset}function a(P){var o;try{o=qq.parseJson(P.responseText)}catch(O){f("Error when attempting to parse xhr response text ("+O+")","error");o={}}return o}function e(o){f("Server has ordered chunking effort to be restarted on next attempt for file ID "+o,"error");if(j){g(o)}E[o].remainingChunkIdxs=[];delete E[o].loaded}function G(o){E[o].attemptingResume=false;f("Server has declared that it cannot handle resume for file ID "+o+" - starting from the first chunk","error");d.upload(o,true)}function v(Q,o,P){var O=d.getName(Q);if(q.onAutoRetry(Q,O,o,P)){return}else{J(Q,o,P)}}function A(P,O){var o;if(!E[P]){return}f("xhr - server response received for "+P);f("responseText = "+O.responseText);o=a(O);if(K(O,o)){if(o.reset){e(P)}if(E[P].attemptingResume&&o.reset){G(P)}else{v(P,o,O)}}else{if(C){y(P,o,O)}else{J(P,o,O)}}}function H(o){return{partIndex:o.part,startByte:o.start+1,endByte:o.end,totalParts:o.count}}function c(O,o){return function(){if(o.readyState===4){A(O,o)}}}function m(S,O){var o=d.getUuid(S),R=h(S),Q=o+p+O.part,P=q.resume.cookiesExpireIn;qq.setCookie(R,Q,P)}function g(O){var o=h(O);qq.deleteCookie(o)}function B(R){var o=qq.getCookie(h(R)),Q,O,P;if(o){Q=o.indexOf(p);O=o.substr(0,Q);P=parseInt(o.substr(Q+1,o.length-Q),10);return{uuid:O,part:P}}}function h(R){var P=d.getName(R),o=d.getSize(R),O=q.chunking.partSize,Q;Q="qqfilechunk"+p+encodeURIComponent(P)+p+o+p+O;if(w!==undefined){Q+=p+w}return Q}function t(){if(q.resume.id!==null&&q.resume.id!==undefined&&!qq.isFunction(q.resume.id)&&!qq.isObject(q.resume.id)){return q.resume.id}}function I(T,O){var P=d.getName(T),o=0,S,R,Q;if(!E[T].remainingChunkIdxs||E[T].remainingChunkIdxs.length===0){E[T].remainingChunkIdxs=[];if(j&&!O){S=B(T);if(S){R=L(T,S.part);if(q.onResume(T,P,H(R))!==false){o=S.part;E[T].uuid=S.uuid;E[T].loaded=R.start;E[T].attemptingResume=true;f("Resuming "+P+" at partition index "+o)}}}for(Q=z(T)-1;Q>=o;Q-=1){E[T].remainingChunkIdxs.unshift(Q)}}N(T)}function u(S){var O=E[S].file,o=d.getName(S),R,Q,P;E[S].loaded=0;R=D(S);R.upload.onprogress=function(T){if(T.lengthComputable){E[S].loaded=T.loaded;q.onProgress(S,o,T.loaded,T.total)}};R.onreadystatechange=c(S,R);Q=q.paramsStore.getParams(S);P=n(Q,R,O,S);x(S,R);f("Sending upload request for "+S);R.send(P)}d={add:function(o){if(!(o instanceof File)){throw new Error("Passed obj in not a File (in qq.UploadHandlerXhr)")}var O=E.push({file:o})-1;E[O].uuid=qq.getUniqueId();return O},getName:function(O){var o=E[O].file;return(o.fileName!==null&&o.fileName!==undefined)?o.fileName:o.name},getSize:function(O){var o=E[O].file;return o.fileSize!=null?o.fileSize:o.size},getFile:function(o){if(E[o]){return E[o].file}},getLoaded:function(o){return E[o].loaded||0},isValid:function(o){return E[o]!==undefined},reset:function(){E=[]},getUuid:function(o){return E[o].uuid},upload:function(P,o){var O=this.getName(P);q.onUpload(P,O);if(C){I(P,o)}else{u(P)}},cancel:function(o){q.onCancel(o,this.getName(o));if(E[o].xhr){E[o].xhr.abort()}if(j){g(o)}delete E[o]},getResumableFilesData:function(){var o=[],O=[];if(C&&j){if(w===undefined){o=qq.getCookieNames(new RegExp("^qqfilechunk\\"+p+".+\\"+p+"\\d+\\"+p+q.chunking.partSize+"="))}else{o=qq.getCookieNames(new RegExp("^qqfilechunk\\"+p+".+\\"+p+"\\d+\\"+p+q.chunking.partSize+"\\"+p+w+"="))}qq.each(o,function(Q,S){var R=S.split(p);var P=qq.getCookie(S).split(p);O.push({name:decodeURIComponent(R[1]),size:R[2],uuid:P[0],partIdx:P[1]})});return O}return[]}};return d};qq.FineUploaderBasic=function(b){var a=this;this._options={debug:false,button:null,multiple:true,maxConnections:3,disableCancelForFormUploads:false,autoUpload:true,request:{endpoint:"/server/upload",params:{},paramsInBody:false,customHeaders:{},forceMultipart:true,inputName:"qqfile",uuidName:"qquuid",totalFileSizeName:"qqtotalfilesize"},validation:{allowedExtensions:[],sizeLimit:0,minSizeLimit:0,stopOnFirstInvalidFile:true},callbacks:{onSubmit:function(d,c){},onComplete:function(e,d,c){},onCancel:function(d,c){},onUpload:function(d,c){},onUploadChunk:function(e,d,c){},onResume:function(e,d,c){},onProgress:function(f,e,c,d){},onError:function(e,d,c){},onAutoRetry:function(e,d,c){},onManualRetry:function(d,c){},onValidateBatch:function(c){},onValidate:function(c){}},messages:{typeError:"{file} has an invalid extension. Valid extension(s): {extensions}.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",noFilesError:"No files to upload.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},retry:{enableAuto:false,maxAutoAttempts:3,autoAttemptDelay:5,preventRetryResponseProperty:"preventRetry"},classes:{buttonHover:"qq-upload-button-hover",buttonFocus:"qq-upload-button-focus"},chunking:{enabled:false,partSize:2000000,paramNames:{partIndex:"qqpartindex",partByteOffset:"qqpartbyteoffset",chunkSize:"qqchunksize",totalFileSize:"qqtotalfilesize",totalParts:"qqtotalparts",filename:"qqfilename"}},resume:{enabled:false,id:null,cookiesExpireIn:7,paramNames:{resuming:"qqresume"}},formatFileName:function(c){if(c.length>33){c=c.slice(0,19)+"..."+c.slice(-14)}return c},text:{sizeSymbols:["kB","MB","GB","TB","PB","EB"]}};qq.extend(this._options,b,true);this._wrapCallbacks();this._disposeSupport=new qq.DisposeSupport();this._filesInProgress=[];this._storedFileIds=[];this._autoRetries=[];this._retryTimeouts=[];this._preventRetries=[];this._paramsStore=this._createParamsStore();this._endpointStore=this._createEndpointStore();this._handler=this._createUploadHandler();if(this._options.button){this._button=this._createUploadButton(this._options.button)}this._preventLeaveInProgress()};qq.FineUploaderBasic.prototype={log:function(a,b){if(this._options.debug&&(!b||b==="info")){qq.log("[FineUploader] "+a)}else{if(b&&b!=="info"){qq.log("[FineUploader] "+a,b)}}},setParams:function(b,a){if(a==null){this._options.request.params=b}else{this._paramsStore.setParams(b,a)}},setEndpoint:function(b,a){if(a==null){this._options.request.endpoint=b}else{this._endpointStore.setEndpoint(b,a)}},getInProgress:function(){return this._filesInProgress.length},uploadStoredFiles:function(){var a;while(this._storedFileIds.length){a=this._storedFileIds.shift();this._filesInProgress.push(a);this._handler.upload(a)}},clearStoredFiles:function(){this._storedFileIds=[]},retry:function(a){if(this._onBeforeManualRetry(a)){this._handler.retry(a);return true}else{return false}},cancel:function(a){this._handler.cancel(a)},reset:function(){this.log("Resetting uploader...");this._handler.reset();this._filesInProgress=[];this._storedFileIds=[];this._autoRetries=[];this._retryTimeouts=[];this._preventRetries=[];this._button.reset();this._paramsStore.reset();this._endpointStore.reset()},addFiles:function(c){var a=this,e=[],b,d;if(c){if(!window.FileList||!(c instanceof FileList)){c=[].concat(c)}for(b=0;b<c.length;b+=1){d=c[b];if(qq.isFileOrInput(d)){e.push(d)}else{a.log(d+" is not a File or INPUT element!  Ignoring!","warn")}}this.log("Processing "+e.length+" files or inputs...");this._uploadFileList(e)}},getUuid:function(a){return this._handler.getUuid(a)},getResumableFilesData:function(){return this._handler.getResumableFilesData()},getSize:function(a){return this._handler.getSize(a)},getFile:function(a){return this._handler.getFile(a)},_createUploadButton:function(c){var a=this;var b=new qq.UploadButton({element:c,multiple:this._options.multiple&&qq.isXhrUploadSupported(),acceptFiles:this._options.validation.acceptFiles,onChange:function(d){a._onInputChange(d)},hoverClass:this._options.classes.buttonHover,focusClass:this._options.classes.buttonFocus});this._disposeSupport.addDisposer(function(){b.dispose()});return b},_createUploadHandler:function(){var a=this;return new qq.UploadHandler({debug:this._options.debug,forceMultipart:this._options.request.forceMultipart,maxConnections:this._options.maxConnections,customHeaders:this._options.request.customHeaders,inputName:this._options.request.inputName,uuidParamName:this._options.request.uuidName,totalFileSizeParamName:this._options.request.totalFileSizeName,demoMode:this._options.demoMode,paramsInBody:this._options.request.paramsInBody,paramsStore:this._paramsStore,endpointStore:this._endpointStore,chunking:this._options.chunking,resume:this._options.resume,log:function(b,c){a.log(b,c)},onProgress:function(e,d,b,c){a._onProgress(e,d,b,c);a._options.callbacks.onProgress(e,d,b,c)},onComplete:function(e,d,b,c){a._onComplete(e,d,b,c);a._options.callbacks.onComplete(e,d,b)},onCancel:function(c,b){a._onCancel(c,b);a._options.callbacks.onCancel(c,b)},onUpload:function(c,b){a._onUpload(c,b);a._options.callbacks.onUpload(c,b)},onUploadChunk:function(d,c,b){a._options.callbacks.onUploadChunk(d,c,b)},onResume:function(d,c,b){return a._options.callbacks.onResume(d,c,b)},onAutoRetry:function(e,d,c,b){a._preventRetries[e]=c[a._options.retry.preventRetryResponseProperty];if(a._shouldAutoRetry(e,d,c)){a._maybeParseAndSendUploadError(e,d,c,b);a._options.callbacks.onAutoRetry(e,d,a._autoRetries[e]+1);a._onBeforeAutoRetry(e,d);a._retryTimeouts[e]=setTimeout(function(){a._onAutoRetry(e,d,c)},a._options.retry.autoAttemptDelay*1000);return true}else{return false}}})},_preventLeaveInProgress:function(){var a=this;this._disposeSupport.attach(window,"beforeunload",function(b){if(!a._filesInProgress.length){return}var b=b||window.event;b.returnValue=a._options.messages.onLeave;return a._options.messages.onLeave})},_onSubmit:function(b,a){if(this._options.autoUpload){this._filesInProgress.push(b)}},_onProgress:function(d,c,a,b){},_onComplete:function(d,c,a,b){this._removeFromFilesInProgress(d);this._maybeParseAndSendUploadError(d,c,a,b)},_onCancel:function(c,b){this._removeFromFilesInProgress(c);clearTimeout(this._retryTimeouts[c]);var a=qq.indexOf(this._storedFileIds,c);if(!this._options.autoUpload&&a>=0){this._storedFileIds.splice(a,1)}},_removeFromFilesInProgress:function(b){var a=qq.indexOf(this._filesInProgress,b);if(a>=0){this._filesInProgress.splice(a,1)}},_onUpload:function(b,a){},_onInputChange:function(a){if(qq.isXhrUploadSupported()){this.addFiles(a.files)}else{this.addFiles(a)}this._button.reset()},_onBeforeAutoRetry:function(b,a){this.log("Waiting "+this._options.retry.autoAttemptDelay+" seconds before retrying "+a+"...")},_onAutoRetry:function(c,b,a){this.log("Retrying "+b+"...");this._autoRetries[c]++;this._handler.retry(c)},_shouldAutoRetry:function(c,b,a){if(!this._preventRetries[c]&&this._options.retry.enableAuto){if(this._autoRetries[c]===undefined){this._autoRetries[c]=0}return this._autoRetries[c]<this._options.retry.maxAutoAttempts}return false},_onBeforeManualRetry:function(b){if(this._preventRetries[b]){this.log("Retries are forbidden for id "+b,"warn");return false}else{if(this._handler.isValid(b)){var a=this._handler.getName(b);if(this._options.callbacks.onManualRetry(b,a)===false){return false}this.log("Retrying upload for '"+a+"' (id: "+b+")...");this._filesInProgress.push(b);return true}else{this.log("'"+b+"' is not a valid file ID","error");return false}}},_maybeParseAndSendUploadError:function(e,d,b,c){if(!b.success){if(c&&c.status!==200&&!b.error){this._options.callbacks.onError(e,d,"XHR returned response code "+c.status)}else{var a=b.error?b.error:"Upload failure reason unknown";this._options.callbacks.onError(e,d,a)}}},_uploadFileList:function(d){var c,a,b;c=this._getValidationDescriptors(d);b=this._options.callbacks.onValidateBatch(c)===false;if(!b){if(d.length>0){for(a=0;a<d.length;a++){if(this._validateFile(d[a])){this._uploadFile(d[a])}else{if(this._options.validation.stopOnFirstInvalidFile){return}}}}else{this._error("noFilesError","")}}},_uploadFile:function(a){var c=this._handler.add(a);var b=this._handler.getName(c);if(this._options.callbacks.onSubmit(c,b)!==false){this._onSubmit(c,b);if(this._options.autoUpload){this._handler.upload(c)}else{this._storeFileForLater(c)}}},_storeFileForLater:function(a){this._storedFileIds.push(a)},_validateFile:function(d){var a,b,c;a=this._getValidationDescriptor(d);b=a.name;c=a.size;if(this._options.callbacks.onValidate(a)===false){return false}if(!this._isAllowedExtension(b)){this._error("typeError",b);return false}else{if(c===0){this._error("emptyError",b);return false}else{if(c&&this._options.validation.sizeLimit&&c>this._options.validation.sizeLimit){this._error("sizeError",b);return false}else{if(c&&c<this._options.validation.minSizeLimit){this._error("minSizeError",b);return false}}}}return true},_error:function(d,e){var c=this._options.messages[d];function b(f,g){c=c.replace(f,g)}var a=this._options.validation.allowedExtensions.join(", ").toLowerCase();b("{file}",this._options.formatFileName(e));b("{extensions}",a);b("{sizeLimit}",this._formatSize(this._options.validation.sizeLimit));b("{minSizeLimit}",this._formatSize(this._options.validation.minSizeLimit));this._options.callbacks.onError(null,e,c);return c},_isAllowedExtension:function(c){var b=this._options.validation.allowedExtensions,a=false;if(!b.length){return true}qq.each(b,function(d,f){var e=new RegExp("\\."+f+"$","i");if(c.match(e)!=null){a=true;return false}});return a},_formatSize:function(a){var b=-1;do{a=a/1024;b++}while(a>99);return Math.max(a,0.1).toFixed(1)+this._options.text.sizeSymbols[b]},_wrapCallbacks:function(){var a,b;a=this;b=function(e,g,d){try{return g.apply(a,d)}catch(f){a.log("Caught exception in '"+e+"' callback - "+f.message,"error")}};for(var c in this._options.callbacks){(function(){var e,d;e=c;d=a._options.callbacks[e];a._options.callbacks[e]=function(){return b(e,d,arguments)}}())}},_parseFileName:function(b){var a;if(b.value){a=b.value.replace(/.*(\/|\\)/,"")}else{a=(b.fileName!==null&&b.fileName!==undefined)?b.fileName:b.name}return a},_parseFileSize:function(b){var a;if(!b.value){a=(b.fileSize!==null&&b.fileSize!==undefined)?b.fileSize:b.size}return a},_getValidationDescriptor:function(d){var b,c,a;a={};b=this._parseFileName(d);c=this._parseFileSize(d);a.name=b;if(c){a.size=c}return a},_getValidationDescriptors:function(b){var a=this,c=[];qq.each(b,function(d,e){c.push(a._getValidationDescriptor(e))});return c},_createParamsStore:function(){var a={},b=this;return{setParams:function(e,d){var c={};qq.extend(c,e);a[d]=c},getParams:function(d){var c={};if(d!=null&&a[d]){qq.extend(c,a[d])}else{qq.extend(c,b._options.request.params)}return c},remove:function(c){return delete a[c]},reset:function(){a={}}}},_createEndpointStore:function(){var b={},a=this;return{setEndpoint:function(d,c){b[c]=d},getEndpoint:function(c){if(c!=null&&b[c]){return b[c]}return a._options.request.endpoint},remove:function(c){return delete b[c]},reset:function(){b={}}}}};qq.DragAndDrop=function(d){var p,n,m,b=[],j=0,e=0,l=new qq.DisposeSupport();p={dropArea:null,extraDropzones:[],hideDropzones:true,multiple:true,classes:{dropActive:null},callbacks:{dropProcessing:function(o,q){},error:function(q,o){},log:function(o,q){}}};qq.extend(p,d);function a(){if(j===e&&!m){p.callbacks.log("Grabbed "+b.length+" files after tree traversal.");n.dropDisabled(false);p.callbacks.dropProcessing(false,b)}}function g(o){b.push(o);e+=1;a()}function h(r){var q,o;j+=1;if(r.isFile){r.file(function(s){g(s)})}else{if(r.isDirectory){m=true;q=r.createReader();q.readEntries(function(s){e+=1;for(o=0;o<s.length;o+=1){h(s[o])}m=false;if(!s.length){a()}})}}}function k(s){var q,o,r;p.callbacks.dropProcessing(true);n.dropDisabled(true);if(s.files.length>1&&!p.multiple){p.callbacks.dropProcessing(false);p.callbacks.error("tooManyFilesError","");n.dropDisabled(false)}else{b=[];j=0;e=0;if(qq.isFolderDropSupported(s)){o=s.items;for(q=0;q<o.length;q+=1){r=o[q].webkitGetAsEntry();if(r){if(r.isFile){b.push(o[q].getAsFile());if(q===o.length-1){a()}}else{h(r)}}}}else{p.callbacks.dropProcessing(false,s.files);n.dropDisabled(false)}}}function c(o){n=new qq.UploadDropZone({element:o,onEnter:function(q){qq(o).addClass(p.classes.dropActive);q.stopPropagation()},onLeaveNotDescendants:function(q){qq(o).removeClass(p.classes.dropActive)},onDrop:function(q){if(p.hideDropzones){qq(o).hide()}qq(o).removeClass(p.classes.dropActive);k(q.dataTransfer)}});l.addDisposer(function(){n.dispose()});if(p.hideDropzones){qq(o).hide()}}function i(q){var o;qq.each(q.dataTransfer.types,function(r,s){if(s==="Files"){o=true;return false}});return o}function f(){if(p.dropArea){p.extraDropzones.push(p.dropArea)}var o,q=p.extraDropzones;for(o=0;o<q.length;o+=1){c(q[o])}if(p.dropArea&&(!qq.ie()||qq.ie10())){l.attach(document,"dragenter",function(r){if(!n.dropDisabled()&&i(r)){if(qq(p.dropArea).hasClass(p.classes.dropDisabled)){return}p.dropArea.style.display="block";for(o=0;o<q.length;o+=1){q[o].style.display="block"}}})}l.attach(document,"dragleave",function(r){if(p.hideDropzones&&qq.FineUploader.prototype._leaving_document_out(r)){for(o=0;o<q.length;o+=1){qq(q[o]).hide()}}});l.attach(document,"drop",function(r){if(p.hideDropzones){for(o=0;o<q.length;o+=1){qq(q[o]).hide()}}r.preventDefault()})}return{setup:function(){f()},setupExtraDropzone:function(o){p.extraDropzones.push(o);c(o)},removeExtraDropzone:function(r){var q,o=p.extraDropzones;for(q in o){if(o[q]===r){return o.splice(q,1)}}},dispose:function(){l.dispose();n.dispose()}}};qq.UploadDropZone=function(c){var k,e,i,f,h=new qq.DisposeSupport();k={element:null,onEnter:function(l){},onLeave:function(l){},onLeaveNotDescendants:function(l){},onDrop:function(l){}};qq.extend(k,c);e=k.element;function a(){return qq.safari()||(qq.firefox()&&qq.windows())}function d(l){if(!f){if(a){h.attach(document,"dragover",function(m){m.preventDefault()})}else{h.attach(document,"dragover",function(m){if(m.dataTransfer){m.dataTransfer.dropEffect="none";m.preventDefault()}})}f=true}}function b(o){if(qq.ie()&&!qq.ie10()){return false}var n,m=o.dataTransfer,l=qq.safari();n=qq.ie10()?true:m.effectAllowed!=="none";return m&&n&&(m.files||(!l&&m.types.contains&&m.types.contains("Files")))}function j(l){if(l!==undefined){i=l}return i}function g(){h.attach(e,"dragover",function(m){if(!b(m)){return}var l=qq.ie()?null:m.dataTransfer.effectAllowed;if(l==="move"||l==="linkMove"){m.dataTransfer.dropEffect="move"}else{m.dataTransfer.dropEffect="copy"}m.stopPropagation();m.preventDefault()});h.attach(e,"dragenter",function(l){if(!j()){if(!b(l)){return}k.onEnter(l)}});h.attach(e,"dragleave",function(m){if(!b(m)){return}k.onLeave(m);var l=document.elementFromPoint(m.clientX,m.clientY);if(qq(this).contains(l)){return}k.onLeaveNotDescendants(m)});h.attach(e,"drop",function(l){if(!j()){if(!b(l)){return}l.preventDefault();k.onDrop(l)}})}d();g();return{dropDisabled:function(l){return j(l)},dispose:function(){h.dispose()}}};qq.FineUploader=function(a){qq.FineUploaderBasic.apply(this,arguments);qq.extend(this._options,{element:null,listElement:null,dragAndDrop:{extraDropzones:[],hideDropzones:true,disableDefaultDropzone:false},text:{uploadButton:"Upload a file",cancelButton:"Cancel",retryButton:"Retry",failUpload:"Upload failed",dragZone:"Drop files here to upload",dropProcessing:"Processing dropped files...",formatProgress:"{percent}% of {total_size}",waitingForResponse:"Processing..."},template:'<div class="qq-uploader">'+((!this._options.dragAndDrop||!this._options.dragAndDrop.disableDefaultDropzone)?'<div class="qq-upload-drop-area"><span>{dragZoneText}</span></div>':"")+(!this._options.button?'<div class="qq-upload-button"><div>{uploadButtonText}</div></div>':"")+'<span class="qq-drop-processing"><span>{dropProcessingText}</span><span class="qq-drop-processing-spinner"></span></span>'+(!this._options.listElement?'<ul class="qq-upload-list"></ul>':"")+"</div>",fileTemplate:'<li><div class="qq-progress-bar"></div><span class="qq-upload-spinner"></span><span class="qq-upload-finished"></span><span class="qq-upload-file"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">{cancelButtonText}</a><a class="qq-upload-retry" href="#">{retryButtonText}</a><span class="qq-upload-status-text">{statusText}</span></li>',classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",dropDisabled:"qq-upload-drop-area-disabled",list:"qq-upload-list",progressBar:"qq-progress-bar",file:"qq-upload-file",spinner:"qq-upload-spinner",finished:"qq-upload-finished",retrying:"qq-upload-retrying",retryable:"qq-upload-retryable",size:"qq-upload-size",cancel:"qq-upload-cancel",retry:"qq-upload-retry",statusText:"qq-upload-status-text",success:"qq-upload-success",fail:"qq-upload-fail",successIcon:null,failIcon:null,dropProcessing:"qq-drop-processing",dropProcessingSpinner:"qq-drop-processing-spinner"},failedUploadTextDisplay:{mode:"default",maxChars:50,responseProperty:"error",enableTooltip:true},messages:{tooManyFilesError:"You may only drop one file"},retry:{showAutoRetryNote:true,autoRetryNote:"Retrying {retryNum}/{maxAuto}...",showButton:false},showMessage:function(b){setTimeout(function(){alert(b)},0)}},true);qq.extend(this._options,a,true);this._wrapCallbacks();this._options.template=this._options.template.replace(/\{dragZoneText\}/g,this._options.text.dragZone);this._options.template=this._options.template.replace(/\{uploadButtonText\}/g,this._options.text.uploadButton);this._options.template=this._options.template.replace(/\{dropProcessingText\}/g,this._options.text.dropProcessing);this._options.fileTemplate=this._options.fileTemplate.replace(/\{cancelButtonText\}/g,this._options.text.cancelButton);this._options.fileTemplate=this._options.fileTemplate.replace(/\{retryButtonText\}/g,this._options.text.retryButton);this._options.fileTemplate=this._options.fileTemplate.replace(/\{statusText\}/g,"");this._element=this._options.element;this._element.innerHTML=this._options.template;this._listElement=this._options.listElement||this._find(this._element,"list");this._classes=this._options.classes;if(!this._button){this._button=this._createUploadButton(this._find(this._element,"button"))}this._bindCancelAndRetryEvents();this._dnd=this._setupDragAndDrop()};qq.extend(qq.FineUploader.prototype,qq.FineUploaderBasic.prototype);qq.extend(qq.FineUploader.prototype,{clearStoredFiles:function(){qq.FineUploaderBasic.prototype.clearStoredFiles.apply(this,arguments);this._listElement.innerHTML=""},addExtraDropzone:function(a){this._dnd.setupExtraDropzone(a)},removeExtraDropzone:function(a){return this._dnd.removeExtraDropzone(a)},getItemByFileId:function(b){var a=this._listElement.firstChild;while(a){if(a.qqFileId==b){return a}a=a.nextSibling}},cancel:function(a){qq.FineUploaderBasic.prototype.cancel.apply(this,arguments);var b=this.getItemByFileId(a);qq(b).remove()},reset:function(){qq.FineUploaderBasic.prototype.reset.apply(this,arguments);this._element.innerHTML=this._options.template;this._listElement=this._options.listElement||this._find(this._element,"list");if(!this._options.button){this._button=this._createUploadButton(this._find(this._element,"button"))}this._bindCancelAndRetryEvents();this._dnd.dispose();this._dnd=this._setupDragAndDrop()},_setupDragAndDrop:function(){var a=this,e=this._find(this._element,"dropProcessing"),c,d,b;d=function(f){f.preventDefault()};if(!this._options.dragAndDrop.disableDefaultDropzone){b=this._find(this._options.element,"drop")}c=new qq.DragAndDrop({dropArea:b,extraDropzones:this._options.dragAndDrop.extraDropzones,hideDropzones:this._options.dragAndDrop.hideDropzones,multiple:this._options.multiple,classes:{dropActive:this._options.classes.dropActive},callbacks:{dropProcessing:function(g,h){var f=a._button.getInput();if(g){qq(e).css({display:"block"});qq(f).attach("click",d)}else{qq(e).hide();qq(f).detach("click",d)}if(h){a.addFiles(h)}},error:function(g,f){a._error(g,f)},log:function(f,g){a.log(f,g)}}});c.setup();return c},_leaving_document_out:function(a){return((qq.chrome()||(qq.safari()&&qq.windows()))&&a.clientX==0&&a.clientY==0)||(qq.firefox()&&!a.relatedTarget)},_storeFileForLater:function(b){qq.FineUploaderBasic.prototype._storeFileForLater.apply(this,arguments);var a=this.getItemByFileId(b);qq(this._find(a,"spinner")).hide()},_find:function(c,b){var a=qq(c).getByClass(this._options.classes[b])[0];if(!a){throw new Error("element not found "+b)}return a},_onSubmit:function(b,a){qq.FineUploaderBasic.prototype._onSubmit.apply(this,arguments);this._addToList(b,a)},_onProgress:function(a,c,d,g){qq.FineUploaderBasic.prototype._onProgress.apply(this,arguments);var i,e,h,f,b,j;i=this.getItemByFileId(a);e=this._find(i,"progressBar");f=Math.round(d/g*100);if(d===g){b=this._find(i,"cancel");qq(b).hide();qq(e).hide();qq(this._find(i,"statusText")).setText(this._options.text.waitingForResponse);h=this._formatSize(g)}else{h=this._formatProgress(d,g);qq(e).css({display:"block"})}qq(e).css({width:f+"%"});j=this._find(i,"size");qq(j).css({display:"inline"});qq(j).setText(h)},_onComplete:function(e,d,a,c){qq.FineUploaderBasic.prototype._onComplete.apply(this,arguments);var b=this.getItemByFileId(e);qq(this._find(b,"statusText")).clearText();qq(b).removeClass(this._classes.retrying);qq(this._find(b,"progressBar")).hide();if(!this._options.disableCancelForFormUploads||qq.isXhrUploadSupported()){qq(this._find(b,"cancel")).hide()}qq(this._find(b,"spinner")).hide();if(a.success){qq(b).addClass(this._classes.success);if(this._classes.successIcon){this._find(b,"finished").style.display="inline-block";qq(b).addClass(this._classes.successIcon)}}else{qq(b).addClass(this._classes.fail);if(this._classes.failIcon){this._find(b,"finished").style.display="inline-block";qq(b).addClass(this._classes.failIcon)}if(this._options.retry.showButton&&!this._preventRetries[e]){qq(b).addClass(this._classes.retryable)}this._controlFailureTextDisplay(b,a)}},_onUpload:function(c,b){qq.FineUploaderBasic.prototype._onUpload.apply(this,arguments);var a=this.getItemByFileId(c);this._showSpinner(a)},_onBeforeAutoRetry:function(h){var e,g,b,a,f,d,c;qq.FineUploaderBasic.prototype._onBeforeAutoRetry.apply(this,arguments);e=this.getItemByFileId(h);g=this._find(e,"progressBar");this._showCancelLink(e);g.style.width=0;qq(g).hide();if(this._options.retry.showAutoRetryNote){a=this._find(e,"statusText");f=this._autoRetries[h]+1;d=this._options.retry.maxAutoAttempts;c=this._options.retry.autoRetryNote.replace(/\{retryNum\}/g,f);c=c.replace(/\{maxAuto\}/g,d);qq(a).setText(c);if(f===1){qq(e).addClass(this._classes.retrying)}}},_onBeforeManualRetry:function(b){if(qq.FineUploaderBasic.prototype._onBeforeManualRetry.apply(this,arguments)){var a=this.getItemByFileId(b);this._find(a,"progressBar").style.width=0;qq(a).removeClass(this._classes.fail);qq(this._find(a,"statusText")).clearText();this._showSpinner(a);this._showCancelLink(a);return true}return false},_addToList:function(e,d){var b=qq.toElement(this._options.fileTemplate);if(this._options.disableCancelForFormUploads&&!qq.isXhrUploadSupported()){var a=this._find(b,"cancel");qq(a).remove()}b.qqFileId=e;var c=this._find(b,"file");qq(c).setText(this._options.formatFileName(d));qq(this._find(b,"size")).hide();if(!this._options.multiple){this._clearList()}this._listElement.appendChild(b)},_clearList:function(){this._listElement.innerHTML="";this.clearStoredFiles()},_bindCancelAndRetryEvents:function(){var a=this,b=this._listElement;this._disposeSupport.attach(b,"click",function(f){f=f||window.event;var d=f.target||f.srcElement;if(qq(d).hasClass(a._classes.cancel)||qq(d).hasClass(a._classes.retry)){qq.preventDefault(f);var c=d.parentNode;while(c.qqFileId==undefined){c=d=d.parentNode}if(qq(d).hasClass(a._classes.cancel)){a.cancel(c.qqFileId)}else{qq(c).removeClass(a._classes.retryable);a.retry(c.qqFileId)}}})},_formatProgress:function(d,a){var c=this._options.text.formatProgress;function b(e,f){c=c.replace(e,f)}b("{percent}",Math.round(d/a*100));b("{total_size}",this._formatSize(a));return c},_controlFailureTextDisplay:function(c,b){var f,d,a,g,e;f=this._options.failedUploadTextDisplay.mode;d=this._options.failedUploadTextDisplay.maxChars;a=this._options.failedUploadTextDisplay.responseProperty;if(f==="custom"){g=b[a];if(g){if(g.length>d){e=g.substring(0,d)+"..."}}else{g=this._options.text.failUpload;this.log("'"+a+"' is not a valid property on the server response.","warn")}qq(this._find(c,"statusText")).setText(e||g);if(this._options.failedUploadTextDisplay.enableTooltip){this._showTooltip(c,g)}}else{if(f==="default"){qq(this._find(c,"statusText")).setText(this._options.text.failUpload)}else{if(f!=="none"){this.log("failedUploadTextDisplay.mode value of '"+f+"' is not valid","warn")}}}},_showTooltip:function(a,b){a.title=b},_showSpinner:function(a){var b=this._find(a,"spinner");b.style.display="inline-block"},_showCancelLink:function(b){if(!this._options.disableCancelForFormUploads||qq.isXhrUploadSupported()){var a=this._find(b,"cancel");a.style.display="inline"}},_error:function(b,c){var a=qq.FineUploaderBasic.prototype._error.apply(this,arguments);this._options.showMessage(a)}});(function(e){var f,k,j,c,i,b,g,a,d,h;b=["uploaderType"];j=function(l){if(l){var m=a(l);g(m);if(i("uploaderType")==="basic"){f(new qq.FineUploaderBasic(m))}else{f(new qq.FineUploader(m))}}return k};c=function(l,n){var m=k.data("fineuploader");if(n){if(m===undefined){m={}}m[l]=n;k.data("fineuploader",m)}else{if(m===undefined){return null}return m[l]}};f=function(l){return c("uploader",l)};i=function(l,m){return c(l,m)};g=function(l){var m=l.callbacks={};e.each(new qq.FineUploaderBasic()._options.callbacks,function(q,p){var o,n;o=/^on(\w+)/.exec(q)[1];o=o.substring(0,1).toLowerCase()+o.substring(1);n=k;m[q]=function(){var r=Array.prototype.slice.call(arguments);return n.triggerHandler(o,r)}})};a=function(n,m){var o,l;if(m===undefined){if(n.uploaderType!=="basic"){o={element:k[0]}}else{o={}}}else{o=m}e.each(n,function(q,p){if(e.inArray(q,b)>=0){i(q,p)}else{if(p instanceof e){o[q]=p[0]}else{if(e.isPlainObject(p)){o[q]={};a(p,o[q])}else{if(e.isArray(p)){l=[];e.each(p,function(r,s){if(s instanceof e){e.merge(l,s)}else{l.push(s)}});o[q]=l}else{o[q]=p}}}}});if(m===undefined){return o}};d=function(l){return e.type(l)==="string"&&!l.match(/^_/)&&f()[l]!==undefined};h=function(n){var m=[],l=Array.prototype.slice.call(arguments,1);a(l,m);return f()[n].apply(f(),m)};e.fn.fineUploader=function(n){var m=this,l=arguments,o=[];this.each(function(p,q){k=e(q);if(f()&&d(n)){o.push(h.apply(m,l));if(m.length===1){return false}}else{if(typeof n==="object"||!n){j.apply(m,l)}else{e.error("Method "+n+" does not exist on jQuery.fineUploader")}}});if(o.length===1){return o[0]}else{if(o.length>1){return o}}return this}}(jQuery));